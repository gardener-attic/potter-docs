<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">

  <head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Project Potter Website"><meta name="copyright" content="Copyright 2020 Potter project authors.">
  
  <title>Named Secrets :: Potter</title>
  <link rel="icon" type="image/x-icon" href='https://gardener.github.io/potter-docs/images/favicon.ico'>
  <link rel="icon" type="image/png"    href='https://gardener.github.io/potter-docs/images/favicon-32x32.png' sizes="32x32">
  <link rel="icon" type="image/png"    href='https://gardener.github.io/potter-docs/images/favicon-16x16.png' sizes="16x16">
  
  
    
  

  
  <link href="/potter-docs/css/nucleus.css?1613575495" rel="stylesheet">
  <link href="/potter-docs/css/font-awesome.min.css?1613575495" rel="stylesheet">
  <link href="/potter-docs/css/hybrid.css?1613575495" rel="stylesheet">
  <link href="/potter-docs/css/featherlight.min.css?1613575495" rel="stylesheet">
  <link href="/potter-docs/css/perfect-scrollbar.min.css?1613575495" rel="stylesheet">
  <link href="/potter-docs/css/auto-complete.css?1613575495" rel="stylesheet">
  <link href="/potter-docs/css/skeleton.css?1613575495" rel="stylesheet">
  <link href="/potter-docs/css/sheetslider.css?1613575495" rel="stylesheet">

  
  
  
  
  <link rel="stylesheet" href="/potter-docs/css/gardener.7593938070d708e7b1bec0e9172492ff8f780d7c20e680f994075d57795a3335.css">
  
  <script src="/potter-docs/js/moment.js?1613575495"></script>
  <script src="/potter-docs/js/vivus.js?1613575495"></script>
  <script src="/potter-docs/js/scrollreveal.js?1613575495"></script>
  <script src="/potter-docs/js/inlineSVG.js?1613575495"></script>
  <script src="/potter-docs/js/jquery.min.js?1613575495"></script>
  <script src="/potter-docs/js/fixed.js?1613575495"></script>
  <script src="/potter-docs/js/clipboard.min.js?1613575495"></script>

  <script src="https://platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>
  

</head>


  <body data-url="/potter-docs/controller-docs-0.3.0/docs/special-topics/named-secrets/" class="has-sticky-navigation">
      
    <script>
  $(document).ready(function () {
    function initStickyNav() {
      var stickyPoint;
      var tln = document.querySelector(".tln");
      if (!tln) {
        return;
      }
      var stickyPointEl = document.querySelector(".sticky-nav-point");
      if (stickyPointEl == null) {
        stickyPointEl = document.querySelector("body");
        stickyPoint = 0;
      } else {
        stickyPoint = stickyPointEl.clientHeight + stickyPointEl.offsetTop;
      }
      var bodySelector = document.getElementsByTagName("body")[0];
      var tlnHeight = tln.clientHeight;
      var stickyNavigation = function () {
        if (window.pageYOffset + tlnHeight >= stickyPoint) {
          bodySelector.classList.add("has-sticky-navigation");
          tln.classList.add("sticky-top");
        } else {
          bodySelector.classList.remove("has-sticky-navigation");
          tln.classList.remove("sticky-top");
        }
      }

      window.onscroll = function () {
        stickyNavigation();
      };
    }
    initStickyNav();

    function closeAllSelect() {
      document.getElementById("docOptions").classList.remove("show");
    }

    function show(e) {
      e.stopPropagation();
      document.getElementById("docOptions").classList.add("show");
    }

    document.addEventListener("click", closeAllSelect);
    document.getElementById("docSelector").addEventListener("click", show);
  });

</script>

<div class="tln fixedsticky sticky-top"><header class="navigation">
    <div class="container">
      <div class="navigation-wrapper">
        <a href="/potter-docs/" class="logo">
          <img src="/potter-docs/images/logo.png" />
          <span class="title">Potter</span>
        </a>
        <a class="nav-button navbar-toggler" href="#"><i class="fa fa-bars"></i></a>
        
        <div class="navbar-collapse">
          <ul class="links">
            
            <li class="link ">
              <a href="/potter-docs/contribute/">Contribute</a>
            </li>
            
            
            
            <li class="link has-child active">









<a id="docSelector">Controller Docs 0.3.0</a>
<div id="docOptions" class="doc-options">
    <ul><li>
            
            
            
            
            
            
            
            <a href="https://gardener.github.io/potter-docs///controller-docs/home">Controller Docs
                0.48.0
            </a>
            
        </li><li>
            
            
            
            
            
            
            
            <a href="https://gardener.github.io/potter-docs///controller-docs-0.4.0/home">Controller Docs
                0.4.0
            </a>
            
        </li><li>
            
            
            
            
            
            
            
            <a href="https://gardener.github.io/potter-docs///controller-docs-0.3.0/home" class="activeVersion">Controller Docs
                0.3.0
            </a>
            
        </li></ul>
</div>
              
            </li>
            
            
            
            
            
            
            <li class="link has-child">
              <a href="/potter-docs/hub-docs/home">Hub Docs</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </header>
</div>
<script>
  
  $(".navigation .navbar-toggler").click(function (evt) {
    $(".navigation .navbar-collapse").toggle();
    $(".navigation").toggleClass("collapsed");
    $(".navigation .search-box").toggle();
  })
</script>





<style>
  #docSelector {
    cursor: pointer;
  }

  .doc-options {
    position: fixed;
    background-color: #0b8062;
    text-align: left;
    display: none;
  }

  .doc-options ul li {
    margin-bottom: 0;
  }

  .doc-options ul li a:hover {
    background-color: #0c694f;
  }

  .doc-options ul {
    list-style: none;
    padding: 0px;
    margin: 0px;
    text-align: left;
  }

  .doc-options ul li a {
    padding: 10px;
    margin: 0;
  }

  .doc-options .activeVersion {
    background-color: #ec682a;
  }

  .show {
    display: block;
  }
</style>
    
    
  
<div class="sln">
    <div class="overlay-band">
        <ul class="nav-list container">
            
            <li title="Home"><a class="navbar-link" href="/potter-docs/controller-docs-0.3.0/home/">Home</a>
            </li>
            
            
            
            
            
            
            <li title="Docs"><a class="navbar-link is-active" href="/potter-docs/controller-docs-0.3.0/docs/">Docs</a>
            </li>
            
            
            
            
            
        </ul>
    </div>
</div>

    
    <div class="main container">
      
  <nav id="sidebar" class="collapsed container menu">

    <div class="highlightable">
        <ul class="topics"><li data-nav-id="/potter-docs/controller-docs-0.3.0/docs/" title="Docs" class="dd-item parent root  collapsible" data-depth="0">
        <a href="/potter-docs/controller-docs-0.3.0/docs/"><span class="menu-item-text">Docs</span>
        </a><ul><li data-nav-id="/potter-docs/controller-docs-0.3.0/docs/helm-example/" title="Cluster-BoM Example with Helm Applications" class="dd-item top-level" data-depth="1">
        <a href="/potter-docs/controller-docs-0.3.0/docs/helm-example/"><span class="toggle"></span><span class="menu-item-text">Cluster-BoM Example with Helm Applications</span>
        </a></li><li data-nav-id="/potter-docs/controller-docs-0.3.0/docs/kapp-example/" title="Cluster-BoM Example with kapp Applications" class="dd-item top-level" data-depth="1">
        <a href="/potter-docs/controller-docs-0.3.0/docs/kapp-example/"><span class="toggle"></span><span class="menu-item-text">Cluster-BoM Example with kapp Applications</span>
        </a></li><li data-nav-id="/potter-docs/controller-docs-0.3.0/docs/plain-yaml-example/" title="Cluster-BoM Example with plain yaml K8s resources" class="dd-item top-level" data-depth="1">
        <a href="/potter-docs/controller-docs-0.3.0/docs/plain-yaml-example/"><span class="toggle"></span><span class="menu-item-text">Cluster-BoM Example with plain yaml K8s resources</span>
        </a></li><li data-nav-id="/potter-docs/controller-docs-0.3.0/docs/status/" title="Cluster-BoM Status Section explained" class="dd-item top-level" data-depth="1">
        <a href="/potter-docs/controller-docs-0.3.0/docs/status/"><span class="toggle"></span><span class="menu-item-text">Cluster-BoM Status Section explained</span>
        </a></li><li data-nav-id="/potter-docs/controller-docs-0.3.0/docs/special-topics/" title="Special Topics" class="dd-item parent top-level collapsible" data-depth="1">
        <a href="/potter-docs/controller-docs-0.3.0/docs/special-topics/">
            <span class="toggle fa fa-angle-down"></span><span class="menu-item-text">Special Topics</span>
        </a><ul><li data-nav-id="/potter-docs/controller-docs-0.3.0/docs/special-topics/fetching-resources-from-private-github-repo/" title="Fetching Resources From a private GitHub Repository" class="dd-item" data-depth="2">
        <a href="/potter-docs/controller-docs-0.3.0/docs/special-topics/fetching-resources-from-private-github-repo/"><span class="toggle"></span><span class="menu-item-text">Fetching Resources From a private GitHub Repository</span>
        </a></li><li data-nav-id="/potter-docs/controller-docs-0.3.0/docs/special-topics/gitops/" title="GitOps" class="dd-item" data-depth="2">
        <a href="/potter-docs/controller-docs-0.3.0/docs/special-topics/gitops/"><span class="toggle"></span><span class="menu-item-text">GitOps</span>
        </a></li><li data-nav-id="/potter-docs/controller-docs-0.3.0/docs/special-topics/manual-reconcile/" title="Manual Reconcile" class="dd-item" data-depth="2">
        <a href="/potter-docs/controller-docs-0.3.0/docs/special-topics/manual-reconcile/"><span class="toggle"></span><span class="menu-item-text">Manual Reconcile</span>
        </a></li><li data-nav-id="/potter-docs/controller-docs-0.3.0/docs/special-topics/named-secrets/" title="Named Secrets" class="dd-item parent active" data-depth="2">
        <a href="/potter-docs/controller-docs-0.3.0/docs/special-topics/named-secrets/"><span class="toggle"></span><span class="menu-item-text">Named Secrets</span>
        </a></li><li data-nav-id="/potter-docs/controller-docs-0.3.0/docs/special-topics/resource-ready-requirements/" title="Ready Requirements" class="dd-item" data-depth="2">
        <a href="/potter-docs/controller-docs-0.3.0/docs/special-topics/resource-ready-requirements/"><span class="toggle"></span><span class="menu-item-text">Ready Requirements</span>
        </a></li><li data-nav-id="/potter-docs/controller-docs-0.3.0/docs/special-topics/secret-handling/" title="Secret Handling" class="dd-item" data-depth="2">
        <a href="/potter-docs/controller-docs-0.3.0/docs/special-topics/secret-handling/"><span class="toggle"></span><span class="menu-item-text">Secret Handling</span>
        </a></li></ul></li></ul></li></ul>
    </div>
</nav>
<a href="#" class="menu-toggler"><i class="fa fa-angle-double-left"></i></a>

<script>
    $(document).ready(function(){
        $("#sidebar .dd-item:not(.top-level):not(.parent)").hide();
        $("#sidebar .dd-item.parent").siblings(".dd-item").show();
        $('.dd-item', "#sidebar .dd-item.parent").show();

        
        $(".menu-toggler").click(function(evt){
            $("#sidebar").toggleClass("collapsed");
            $(".menu-toggler span").toggleClass("fa-angle-double-left");
            $(".menu-toggler span").toggleClass("fa-angle-double-right");
        });
    })
</script>

      <section>
        
        <div class="highlightable body-inner-wrapper">
          
          
          <div id="body-inner" class="">
            
<div class="docs page"><h1>Named Secrets</h1>
  <div class="properties">
      
  </div>
  
    

	<h2 id="basics-and-example">Basics and Example</h2>
<p>Named secret values allow to specify secret values in a Cluster-BoM which are automatically moved to secrets before the Cluster-BoM is stored or updated. These secrets could be referenced in kapp deployments via their logical names. In helm deployments the secret values stored in the secrets are added as additional values files for templating.</p>
<p>The following example shows a Cluster-BoM with a section <code>namedSecretValues</code> with two named secret values <code>potter-examples-access</code> and <code>otherSecrets</code>. Make sure that the values of the top level map entries under <code>data</code> are strings.</p>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">hub.k8s.sap.com/v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ClusterBom</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pot-namedsecretvalues-kapp</span><span class="w">
</span><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;some-garden-namespace&gt;</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">applicationConfigs</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="nt">configType</span><span class="p">:</span><span class="w"> </span><span class="l">kapp</span><span class="w">
</span><span class="w">    </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">appId1</span><span class="w">
</span><span class="w">    </span><span class="nt">namedSecretValues</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">potter-examples-access</span><span class="p">:</span><span class="w">          </span><span class="c"># logical secret name</span><span class="w">
</span><span class="w">        </span><span class="nt">data</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l">YOUR_USER         </span><span class="w"> </span><span class="c"># moved to secret</span><span class="w">
</span><span class="w">          </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l">YOUR_ACCESS_TOKEN </span><span class="w"> </span><span class="c"># moved to secret</span><span class="w">
</span><span class="w">      </span><span class="nt">otherSecrets</span><span class="p">:</span><span class="w">        
</span><span class="w">        </span><span class="nt">data</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="nt">otherSecret1</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span><span class="sd">            secret1: s11
</span><span class="sd">            secret2: s21</span><span class="w">            
</span><span class="w">          </span><span class="nt">otherSecret2</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span><span class="sd">            secret3: 
</span><span class="sd">              user: users3
</span><span class="sd">              password: pw3</span><span class="w">            
</span><span class="w">    </span><span class="nt">typeSpecificData</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">fetch</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="nt">git</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="nt">ref</span><span class="p">:</span><span class="w"> </span><span class="l">origin/master</span><span class="w">
</span><span class="w">          </span><span class="nt">subPath</span><span class="p">:</span><span class="w"> </span><span class="l">namedsecretvalues/kapp/resources</span><span class="w">
</span><span class="w">          </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">https://github.tools.sap/kubernetes/potter-examples</span><span class="w">
</span><span class="w">          </span><span class="nt">secretRef</span><span class="p">:</span><span class="w">
</span><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">potter-examples-access</span><span class="w">
</span><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="nt">ytt</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span><span class="w">      </span><span class="nt">deploy</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="nt">kapp</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span><span class="w">  </span><span class="nt">secretRef</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;clusterName&gt;.kubeconfig</span><span class="w">
</span></code></pre></div><p>When this Cluster-BoM is deployed, the data of <code>potter-examples-access</code> and <code>otherSecrets</code> are stored in two automatically generated secrets in the following format:</p>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Secret</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="c"># internal secret name, not the logical secret name  </span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pot-namedsecretvalues-kapp-appId1-&lt;someGuid1&gt;</span><span class="w">
</span><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;some-garden-namespace&gt;</span><span class="w">
</span><span class="w"></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Opaque</span><span class="w">
</span><span class="w"></span><span class="nt">data</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l">YOUR_USER        </span><span class="w">
</span><span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l">YOUR_ACCESS_TOKEN</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Secret</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="c"># internal secret name, not the logical secret name  </span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pot-namedsecretvalues-kapp-appId1-&lt;someGuid2&gt;</span><span class="w">
</span><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;some-garden-namespace&gt;</span><span class="w">
</span><span class="w"></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Opaque</span><span class="w">
</span><span class="w"></span><span class="nt">data</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">otherSecret1</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">secret1</span><span class="p">:</span><span class="w"> </span><span class="l">s11</span><span class="w">
</span><span class="w">    </span><span class="nt">secret2</span><span class="p">:</span><span class="w"> </span><span class="l">s21</span><span class="w">
</span><span class="w">  </span><span class="nt">otherSecret2</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">secret3</span><span class="p">:</span><span class="w"> 
</span><span class="w">      </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l">users3</span><span class="w">
</span><span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l">pw3</span><span class="w">
</span></code></pre></div><p>The stored Cluster-BoM itself only contains references to these secrets instead of the data:</p>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">hub.k8s.sap.com/v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ClusterBom</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pot-namedsecretvalues-kapp</span><span class="w">
</span><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;some-garden-namespace&gt;</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">applicationConfigs</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="nt">configType</span><span class="p">:</span><span class="w"> </span><span class="l">kapp</span><span class="w">
</span><span class="w">    </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">appId1</span><span class="w">
</span><span class="w">    </span><span class="nt">namedSecretValues</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">potter-examples-access</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">internalSecretName</span><span class="p">:</span><span class="w"> </span><span class="l">pot-namedsecretvalues-kapp-appId1-&lt;someGuid1&gt;</span><span class="w">
</span><span class="w">      </span><span class="nt">otherSecrets</span><span class="p">:</span><span class="w">        
</span><span class="w">        </span><span class="nt">internalSecretName</span><span class="p">:</span><span class="w"> </span><span class="l">pot-namedsecretvalues-kapp-appId1-&lt;someGuid2&gt;</span><span class="w">
</span><span class="w">    </span><span class="nt">typeSpecificData</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">fetch</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="nt">git</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="nt">ref</span><span class="p">:</span><span class="w"> </span><span class="l">origin/master</span><span class="w">
</span><span class="w">          </span><span class="nt">subPath</span><span class="p">:</span><span class="w"> </span><span class="l">namedsecretvalues/kapp/resources</span><span class="w">
</span><span class="w">          </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">https://github.tools.sap/kubernetes/potter-examples</span><span class="w">
</span><span class="w">          </span><span class="nt">secretRef</span><span class="p">:</span><span class="w">
</span><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">potter-examples-access</span><span class="w">
</span><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="nt">ytt</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span><span class="w">      </span><span class="nt">deploy</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="nt">kapp</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span><span class="w">  </span><span class="nt">secretRef</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;clusterName&gt;.kubeconfig</span><span class="w">
</span></code></pre></div><h2 id="usage-of-named-secrets-in-kapp-deployments">Usage of Named Secrets in kapp deployments</h2>
<p>In the section <code>typeSpecificData</code> you see an example how named secret values could be used in a kapp deployment. Here the logical secret name <code>potter-examples-access</code> is specified as the name of a secret ref. During the deployment the secret connected with this logical name is used to access a private git repository. You could enter logical secret names everywhere in the type specific data section of a kapp deployment where a secret ref could be used.</p>
<h2 id="usage-of-named-secrets-in-helm-deployments">Usage of Named Secrets in helm deployments</h2>
<p>In helm deployments, the data of every named secret is provided as an additional values file during templating. These template files are applied after the values specified in the secret values section. There is no predefined order in which the data of the different named secrets are applied.</p>
<p>A named secret could be also referenced in a tarball access as in the following example:</p>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">hub.k8s.sap.com/v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ClusterBom</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pot-namedsecretvalues-authheader</span><span class="w">
</span><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;some-garden-namespace&gt;</span><span class="w">
</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">applicationConfigs</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="nt">configType</span><span class="p">:</span><span class="w"> </span><span class="l">helm</span><span class="w">
</span><span class="w">    </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">echoserver</span><span class="w">
</span><span class="w">    </span><span class="nt">namedSecretValues</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">logical-name-1</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">data</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="nt">authHeader</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Basic dX...3dvcmQ=&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">typeSpecificData</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">tarballAccess</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://sap-hub-incubator.storage.googleapis.com/echo-server-1.0.5.tgz&#34;</span><span class="w"> 
</span><span class="w">        </span><span class="nt">secretRef</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">logical-name-1</span><span class="w">
</span><span class="w">      </span><span class="nt">installName</span><span class="p">:</span><span class="w"> </span><span class="l">echoserver</span><span class="w">
</span><span class="w">      </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;some-target-namespace&gt;</span><span class="w">
</span><span class="w">  </span><span class="nt">secretRef</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;your-clustername&gt;.kubeconfig</span><span class="w">
</span></code></pre></div><p>With this a secret containing the authheader data is automatically created and used for accessing the tgz file. This secret it automatically excluded from being merged as an additional values file during helm template.</p>
<h2 id="update-secret-values">Update Secret Values</h2>
<p>To <strong>keep</strong> the values of a named secret value with logical name <code>X</code> unchanged, there are several possibilities how to specify this in a Cluster-BoM. Either there is no <code>namedSecretValues</code> section at all or it does not contain <code>X</code>. You could also provide the named secret with identical data or no data.</p>
<p>To <strong>replace</strong> the secret values just provide new data.</p>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="w">    </span><span class="nt">namedSecretValues</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">X</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l">...</span><span class="w"> </span><span class="c"># new data</span><span class="w">
</span></code></pre></div><p>It is not allowed to delete named secrets values by just providing an empty data section to prevent accidental deletions.</p>
<h2 id="delete-secret-values">Delete Secret Values</h2>
<p>To <strong>delete</strong> the secret values use the <code>delete</code> operation:</p>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="w">    </span><span class="nt">namedSecretValues</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">X</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">operation</span><span class="p">:</span><span class="w"> </span><span class="l">delete</span><span class="w">
</span></code></pre></div>
	
</div>
            
          </div>
        </div>
        
  
              <div class="howto_tickets">
                
                
                
                
                <a href="https://github.com/gardener/potter-hub/issues/new/choose" target="_blank">
                    <span>Let us know how can we improve.</span>
                    <span>Open <img src="https://gardener.github.io/potter-docs/images/branding/github-mark-logo-green.svg"/> GitHub Issue <i class="fa fa-external-link" aria-hidden="true"></i></span>
                </a>
            </div>
  

      </section>
      
    </div><style>
 
</style>
<footer class="footer">
  <div class="container footer-wrapper">
    <img src="/potter-docs/images/lp/logo.png" alt="Logo Gardener" class="logo"/>
    <ul class="media-wr">
      <li>
        <a target="_blank" href="https://kubernetes.slack.com/archives/CB57N0BFG">
          <img src="/potter-docs/images/branding/slack-logo-white.svg" class="media-icon"/>
          <div class="media-text">Slack</div>
        </a>
      </li>          
      <li>
        <a target="_blank" href="https://github.com/gardener/potter-hub">
          <img src="/potter-docs/images/branding/github-mark-logo.png" class="media-icon" />
          <div class="media-text">GitHub</div>
        </a>
      </li>                   
    </ul>
    <span class="copyright">Copyright 2020 Potter project authors. Privacy Statement</span>
  </div>
</footer>
    
    <script src="/potter-docs/js/perfect-scrollbar.min.js?1613575495"></script>
    <script src="/potter-docs/js/perfect-scrollbar.jquery.min.js?1613575495"></script>
    <script src="/potter-docs/js/jquery.sticky.js?1613575495"></script>
    <script src="/potter-docs/js/featherlight.min.js?1613575495"></script>
    <script src="/potter-docs/js/html5shiv-printshiv.min.js?1613575495"></script>
    <script src="/potter-docs/js/modernizr.custom.71422.js?1613575495"></script>

    <link href="/potter-docs/mermaid/mermaid.css?1613575495" type="text/css" rel="stylesheet" />
    <script src="/potter-docs/mermaid/mermaid.js?1613575495"></script>
    <script src="/potter-docs/js/code-snippets.js?1613575495"></script>
    <script>
      mermaid.initialize({ startOnLoad: true, htmlLables: true });
      function createIssue(issueUrl, page, url) {
          var uri = issueUrl+"?title=Documentation issue on page \""+page+"\"";
          uri = uri+ "&body=\n\n<- DESCRIBE MISSING OR FAULTY DOCUMENTATION HERE->\n\n---\nPage: ["+ page +"]("+
          url+ ")\ndon't remove the link to the page. It's required for the processor"
          var res = encodeURI(uri);
          res +="&labels=area/documentation"
          window.open(res,"issue")
          return false;
      }

      $(document).ready(function() {


        inlineSVG.init();

        $("[data-publishdate]").each(function(){
          $(this).text(moment($(this, "YYYY-MM-DD", "YYYY-MM-DD hh:mm:ss").attr("data-publishdate")).fromNow());
        });
          
        new ClipboardJS('.clipboard-copy');

        $("body").codeSnippets();
      });
    </script>

    
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id="
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    
    
  </body>
</html>